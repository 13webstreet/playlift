@model TRMAudiostem.Models.ManageArtistModel

@{
    ViewBag.Title = "Edit your personal details";
}

<p class="message-success">@ViewBag.StatusMessage</p>
@Html.ActionLink("<-- Go back to profile page", "ManageArtist")

<nav>
    <ul id="menu">
        <li>@Html.ActionLink("Albums", "ArtistAlbums", "Account")</li>
        <li>@Html.ActionLink("Songs", "ArtistSongs", "Account")</li>
        <li>@Html.ActionLink("Personal Details", "ArtistDetails", "Account")</li>
        <li>@Html.ActionLink("Change Password", "PasswordChange", "Account")</li>
    </ul>
</nav>

@using (Html.BeginForm("ArtistDetails", "Account", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary()

    var TRMWCFWebServiceJson = new TRMWebService.TRMWCFWebServiceJson();
    var genreList = TRMWCFWebServiceJson.GetAllGenres();
    var profileImagePath = string.Empty;
    if (Model != null)
    {
        profileImagePath = TRMAudiostem.AudiostemBase.StreamingUrl + Model.ProfileImagePath;
    }

    <fieldset class="registrationForm">
        <legend>Personal Details</legend>
        <ol>
            <li>
                @Html.LabelFor(m => m.ProfileImage)

                @{
                    if (Model != null && !string.IsNullOrEmpty(Model.ProfileImagePath))
                    {
                        <img src="@profileImagePath" alt="@User.Identity.Name + ' profile image'" width="100" /> 
                        <input type="hidden" name="ProfileImagePath" value="@Model.ProfileImagePath" />                       
                    }   
                }
                <br />
                <input type="file" name="ProfileImage" />          
            </li>            
            <li>
                @Html.LabelFor(m => m.ArtistName)
                @Html.TextBoxFor(m => m.ArtistName)
            </li>
            <li>
                @Html.LabelFor(m => m.Email)
                @Html.TextBoxFor(m => m.Email)
            </li>
            <li>
                @Html.LabelFor(m => m.Website)
                @Html.TextBoxFor(m => m.Website)
            </li>
            <li>
                @Html.LabelFor(m => m.SoundCloud)
                @Html.TextBoxFor(m => m.SoundCloud)
            </li>
            <li>
                @Html.LabelFor(m => m.Facebook)
                @Html.TextBoxFor(m => m.Facebook)
            </li>
            <li>
                @Html.LabelFor(m => m.Twitter)
                @Html.TextBoxFor(m => m.Twitter)
            </li>
            <li>
                @Html.LabelFor(m => m.MySpace)
                @Html.TextBoxFor(m => m.MySpace)
            </li>  
            <li>
                @Html.Label("Royalties Collection Agency Status")

                @if (Model.PRS) 
                {
                    @Html.CheckBoxFor(m => m.PRS, new { @class = "royalty", id = "prs", onchange = "validateRoyalty('prs');", @checked = "checked" })
                    <span>Are you registered with PRS for music?</span>
                    @Html.Partial("_InfoHelper", new TRMAudiostem.Models.InfoHelper() { Message = "You cannot use this option if you have a Creative Commons Licence.", AltMessage = "PRS Licence Info" })
                    <br />
                    @Html.CheckBoxFor(m => m.CreativeCommonsLicence, new { @class = "royalty", id = "cc", onchange = "validateRoyalty('cc');", disabled = "disabled" })
                    <span>Do you have a Creative Commons Licence?</span>
                    @Html.Partial("_InfoHelper", new TRMAudiostem.Models.InfoHelper() { Message = "You cannot use this option if you have a PRS Licence.", AltMessage = "Creative Commons Licence Info" })
                }
                else if (Model.CreativeCommonsLicence)
                {
                    @Html.CheckBoxFor(m => m.PRS, new { @class = "royalty", id = "prs", onchange = "validateRoyalty('prs');", disabled = "disabled" })
                    <span>Are you registered with PRS for music?</span>
                    @Html.Partial("_InfoHelper", new TRMAudiostem.Models.InfoHelper() { Message = "You cannot use this option if you have a Creative Commons Licence.", AltMessage = "PRS Licence Info" })
                    <br />
                    @Html.CheckBoxFor(m => m.CreativeCommonsLicence, new { @class = "royalty", id = "cc", onchange = "validateRoyalty('cc');", @checked = "checked" })
                    <span>Do you have a Creative Commons Licence?</span>
                    @Html.Partial("_InfoHelper", new TRMAudiostem.Models.InfoHelper() { Message = "You cannot use this option if you have a PRS Licence.", AltMessage = "Creative Commons Licence Info" })
                }
                else if (!Model.PRS && !Model.CreativeCommonsLicence)
                {
                    @Html.CheckBoxFor(m => m.PRS, new { @class = "royalty", id = "prs", onchange = "validateRoyalty('prs');" })
                    <span>Are you registered with PRS for music?</span>
                    @Html.Partial("_InfoHelper", new TRMAudiostem.Models.InfoHelper() { Message = "You cannot use this option if you have a Creative Commons Licence.", AltMessage = "PRS Licence Info" })
                    <br />
                    @Html.CheckBoxFor(m => m.CreativeCommonsLicence, new { @class = "royalty", id = "cc", onchange = "validateRoyalty('cc');" })
                    <span>Do you have a Creative Commons Licence?</span>
                    @Html.Partial("_InfoHelper", new TRMAudiostem.Models.InfoHelper() { Message = "You cannot use this option if you have a PRS Licence.", AltMessage = "Creative Commons Licence Info" })
                }
            </li>
                @Html.LabelFor(m => m.GenreCollection)
                @{
                    if (Model != null)
                    {
                        foreach (var artistGenre in Model.GenreCollection)
                        {
                            foreach (var genre in genreList)
                            {
                                if (genre.GenreId == artistGenre.GenreId)
                                {
                                    genre.Selected = true;
                                }
                            }
                        }
                    }

                    Html.RenderPartial("GenreList", genreList);
                }
        </ol>
        <input type="submit" value="Save Personal Details" />
        <input type="hidden" name="UserName" />
    </fieldset>
}

@section Scripts {
    @Scripts.Render("~/bundles/trm/scripts")
}